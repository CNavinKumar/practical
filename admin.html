<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Support Tickets</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div class="container">
    <h1>Admin Dashboard - Manage Tickets</h1>
    <button onclick="loadTickets()">ðŸ”„ Refresh Tickets</button>

    <div id="ticketList"></div>
  </div>

  <script>
    function loadTickets() {
      const tickets = JSON.parse(localStorage.getItem('tickets')) || [];
      const container = document.getElementById('ticketList');
      
      if (tickets.length === 0) {
        container.innerHTML = "<p>No tickets found.</p>";
        return;
      }

      container.innerHTML = tickets.map(t => `
        <div class="ticket-card">
          <h3>${t.subject} <span class="status ${t.status}">${t.status}</span></h3>
          <p><strong>ID:</strong> ${t.id}</p>
          <p><strong>User:</strong> ${t.name} (${t.email})</p>
          <p><strong>Priority:</strong> ${t.priority}</p>
          <p><strong>Created:</strong> ${t.createdAt}</p>
          <p><strong>Description:</strong> ${t.description}</p>

          <label>Status:</label>
          <select id="status-${t.id}">
            <option ${t.status === 'Open' ? 'selected' : ''}>Open</option>
            <option ${t.status === 'In Progress' ? 'selected' : ''}>In Progress</option>
            <option ${t.status === 'Resolved' ? 'selected' : ''}>Resolved</option>
          </select>

          <button onclick="updateTicket(${t.id})">ðŸ’¾ Update</button>
        </div>
      `).join('');
    }

    function updateTicket(id) {
      let tickets = JSON.parse(localStorage.getItem('tickets')) || [];
      const newStatus = document.getElementById('status-' + id).value;

      const index = tickets.findIndex(t => t.id === id);
      if (index !== -1) {
        tickets[index].status = newStatus;
        localStorage.setItem('tickets', JSON.stringify(tickets));
        alert(`Ticket ${id} updated to "${newStatus}"`);
        loadTickets();
      }
    }

    window.onload = loadTickets;
  </script>

</body>
</html>
